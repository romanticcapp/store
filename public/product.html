<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>Product</title>
<style>
body{font-family:system-ui;padding:30px}
img{width:300px;border-radius:12px;margin:5px}
</style>
</head>
<body>

<div id="product"></div>

<script>
const params = new URLSearchParams(location.search);
const id = params.get('id');

fetch('/api/products/'+id)
.then(res=>res.json())
.then(p=>{

const finalPrice = p.discount
? p.price - (p.price * p.discount/100)
: p.price;

product.innerHTML=`
<h1>${p.name}</h1>

${p.images.map(img=>`<img src="${img}">`).join('')}

<h2>${finalPrice} Ø¬Ù†ÙŠÙ‡</h2>
<p>${p.details}</p>
<h3>Ø§Ù„Ù…Ø®Ø²ÙˆÙ†: ${p.stock}</h3>

<button onclick="orderNow()">Ø§Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù†</button>
`;

window.productData=p;
});

function orderNow(){
const name=prompt("Ø§Ø³Ù…Ùƒ");
const phone=prompt("Ø±Ù‚Ù…Ùƒ");
const address=prompt("Ø¹Ù†ÙˆØ§Ù†Ùƒ");

fetch('/api/orders',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({
customer:name,
phone,
address,
product:productData
})
});

alert("ØªÙ… Ø§Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ ðŸ”¥");
}
</script>

</body>
</html>
